import{j as e,c as b,ao as u,b as p,ap as j,aq as f,a0 as y,ar as v,as as N,at as x,L as a,z as o}from"./index-DbUEaAMy.js";import{u as w}from"./useQuery-BhrWanxj.js";import{r as n}from"./react-Dp4Gqg7U.js";import{f as C,r as k,g as F}from"./admin.api-hQNrEoI-.js";import"./firebase-Co7q5P-C.js";import"./firebase-CmtxdFcx.js";function D(){const{data:r}=w({queryKey:["adminStats"],queryFn:F,staleTime:3e5}),[s,m]=n.useState(null),[d,i]=n.useState(!1),l=async()=>{try{const t=await C();m(t)}catch(t){console.error("Health check failed",t)}};n.useEffect(()=>{l();const t=setInterval(l,3e4);return()=>clearInterval(t)},[]);const h=async()=>{if(!window.confirm(`정말 모든 시스템 캐시를 초기화하시겠습니까?
잠시 동안 서비스 속도가 느려질 수 있습니다.`))return;i(!0);const t=o.loading("캐시 초기화 중...");try{await k(),o.success("캐시가 성공적으로 초기화되었습니다.",{id:t}),l()}catch{o.error("캐시 초기화 실패",{id:t})}finally{i(!1)}},g=[{label:"총 등록 장소",value:(r==null?void 0:r.spotCount)||0,icon:e.jsx(b,{}),color:"bg-blue-500",to:"/admin/spots"},{label:"총 회원수",value:(r==null?void 0:r.userCount)||0,icon:e.jsx(u,{}),color:"bg-orange-500",to:"/admin/users"},{label:"진행중 이벤트",value:(r==null?void 0:r.eventCount)||0,icon:e.jsx(p,{}),color:"bg-purple-500",to:"/admin/events"},{label:"활성 광고주",value:(r==null?void 0:r.sponsorCount)||0,icon:e.jsx(j,{}),color:"bg-emerald-500",to:"/admin/sponsors"}];return e.jsxs("div",{className:"p-8 max-w-7xl mx-auto space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"대시보드"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"플랫폼 현황을 한눈에 확인하고 관리하세요."})]}),e.jsxs("div",{className:"text-right text-xs text-gray-400",children:["Last updated: ",new Date().toLocaleTimeString()]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white p-6 rounded-2xl shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(f,{className:(s==null?void 0:s.status)==="healthy"?"text-green-500":"text-red-500"}),"시스템 상태 (System Health)"]}),(s==null?void 0:s.status)==="healthy"?e.jsxs("span",{className:"bg-green-100 text-green-700 px-3 py-1 rounded-full text-xs font-bold flex items-center gap-1",children:[e.jsx(y,{})," 정상 가동 중"]}):e.jsxs("span",{className:"bg-red-100 text-red-700 px-3 py-1 rounded-full text-xs font-bold flex items-center gap-1",children:[e.jsx(v,{})," 점검 필요"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"DB Latency"}),e.jsx("div",{className:`text-xl font-bold ${Number(s==null?void 0:s.dbLatency)>500?"text-red-500":"text-gray-800"}`,children:s?`${s.dbLatency}ms`:"Checking..."})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Uptime"}),e.jsx("div",{className:"text-xl font-bold text-gray-800",children:s?`${Math.floor(s.uptime/3600)}h ${Math.floor(s.uptime%3600/60)}m`:"-"})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl",children:[e.jsxs("div",{className:"text-xs text-gray-500 mb-1 flex items-center gap-1",children:[e.jsx(N,{})," Memory"]}),e.jsx("div",{className:"text-xl font-bold text-gray-800",children:s?`${s.memory.heapUsed}MB`:"-"})]}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-xl flex flex-col justify-center",children:e.jsx("button",{onClick:l,className:"text-xs font-bold text-blue-600 hover:underline",children:"상태 새로고침"})})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-200 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-800 mb-2 flex items-center gap-2",children:[e.jsx(x,{className:"text-orange-500"})," 관리 도구"]}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"데이터 갱신이 지연되거나 오류 발생 시 캐시를 초기화하세요."})]}),e.jsx("button",{onClick:h,disabled:d,className:`w-full py-3 rounded-xl font-bold text-white shadow-lg transition-all transform active:scale-95 flex items-center justify-center gap-2
              ${d?"bg-gray-400 cursor-not-allowed":"bg-red-500 hover:bg-red-600 shadow-red-500/30"}
            `,children:d?"초기화 중...":e.jsxs(e.Fragment,{children:[e.jsx(x,{})," 시스템 캐시 초기화"]})})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:g.map((t,c)=>e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm hover:shadow-md transition-shadow border border-gray-100 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:t.label}),e.jsx("p",{className:"text-3xl font-bold text-gray-800 mt-1",children:t.value.toLocaleString()}),e.jsx(a,{to:t.to,className:"text-xs font-bold text-blue-500 mt-2 inline-block hover:underline",children:"관리하기 →"})]}),e.jsx("div",{className:`w-12 h-12 rounded-full ${t.color} flex items-center justify-center text-white text-xl shadow-lg opacity-90`,children:t.icon})]},c))}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-900 to-gray-800 p-8 rounded-2xl shadow-lg text-white",children:[e.jsx("h3",{className:"text-xl font-bold mb-2",children:"빠른 작업 (Quick Actions)"}),e.jsx("p",{className:"text-gray-400 text-sm mb-6",children:"자주 사용하는 콘텐츠 관리 기능을 바로 실행하세요."}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(a,{to:"/admin/spots/new",className:"py-4 bg-emerald-500/20 border border-emerald-500/30 rounded-xl text-center font-bold hover:bg-emerald-500 hover:text-white transition backdrop-blur-sm",children:"+ 새 장소 등록"}),e.jsx(a,{to:"/admin/events",className:"py-4 bg-white/10 border border-white/10 rounded-xl text-center font-bold hover:bg-white/20 transition backdrop-blur-sm",children:"이벤트 관리"}),e.jsx(a,{to:"/admin/reports",className:"py-4 bg-white/10 border border-white/10 rounded-xl text-center font-bold hover:bg-white/20 transition backdrop-blur-sm",children:"신고 처리"}),e.jsx(a,{to:"/admin/users",className:"py-4 bg-white/10 border border-white/10 rounded-xl text-center font-bold hover:bg-white/20 transition backdrop-blur-sm",children:"회원 조회"})]})]})]})}export{D as default};
