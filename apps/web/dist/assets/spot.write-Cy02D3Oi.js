import{b as c,o as u,l as g,w as a,k as f,q as p,g as w,u as h,a as y}from"./firebase-Co7q5P-C.js";import{b as i,a as r,s as l,n as d}from"./firestore-DzFVOJbi.js";async function x(t={}){const o=[u("createdAt","desc"),g(t.limit??20)];t.category&&t.category!=="all"&&o.push(a("category","==",t.category)),t.region&&t.region!=="all"&&o.push(a("region","==",t.region)),t.lastDoc&&o.push(f(t.lastDoc));const s=p(l(t.mode),...o),e=await w(s);return{items:e.docs.map(n=>r(n,t.mode)),lastDoc:e.docs.length?e.docs[e.docs.length-1]:null}}async function m(t,o){if(o){const n=await c(i(o,t));if(!n.exists())throw new Error("Spot not found");return r(n,o)}const s=await c(i("explorer",t));if(s.exists())return r(s,"explorer");const e=await c(i("nightlife",t));if(e.exists())return r(e,"nightlife");throw new Error("Spot not found")}async function b(t){const o=t.mode??"explorer",s=d(t),e={...t,mode:o,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),location:s,latitude:Number(t.latitude??s.lat),longitude:Number(t.longitude??s.lng),address:t.address??s.address};await y(l(o),e)}async function A(t,o){const s=o.mode??"explorer",e=d(o),n={...o,mode:s,updatedAt:new Date().toISOString(),location:e,latitude:Number(o.latitude??e.lat),longitude:Number(o.longitude??e.lng),address:o.address??e.address};await h(i(s,t),n)}export{b as a,m as f,x as g,A as u};
