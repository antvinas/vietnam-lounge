import{s as l,G as m,F as h,e as w,f as U,h as A,i as r,d as c,b as f,j as a}from"./firebase-Co7q5P-C.js";import{d as u,a as i}from"./firebase-CmtxdFcx.js";function d(e,s={}){return{id:e,uid:e,email:s.email??"",displayName:s.displayName,photoURL:s.photoURL,role:s.role??"user",status:s.status??"active",createdAt:s.createdAt,updatedAt:s.updatedAt}}async function p(e){const s=e.uid??e.id;if(!s)throw new Error("Missing uid for user document");const t=c(u,"users",s);(await f(t)).exists()||await r(t,{...e,uid:s,createdAt:a(),updatedAt:a()})}async function v(e){const t=(await l(i,e.email,e.password)).user,o=d(t.uid,{email:t.email??e.email,displayName:t.displayName??void 0,photoURL:t.photoURL??void 0});return await p(o),o}async function L(e){const t=(await A(i,e.email,e.password)).user,o=d(t.uid,{email:t.email??e.email,displayName:e.displayName,photoURL:t.photoURL??void 0});return await r(c(u,"users",t.uid),{...o,createdAt:a(),updatedAt:a()}),o}async function N(e){const s=e==="google"?new m:e==="facebook"?new h:new w,o=(await U(i,s)).user,n=d(o.uid,{email:o.email??"",displayName:o.displayName??void 0,photoURL:o.photoURL??void 0});return await p(n),n}export{N as a,v as l,L as r};
