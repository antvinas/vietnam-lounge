import{f as y,h as p,r as j,j as e,n as r}from"./index-DbUEaAMy.js";import{r as c}from"./react-Dp4Gqg7U.js";import{u as w}from"./useQuery-BhrWanxj.js";import{u}from"./useMutation-C76_koY-.js";import{u as v}from"./index.esm-Ca_OQud3.js";import{h as N,i as k,j as S,k as F,l as P}from"./index-FMo13rtH.js";import{u as q,w as C,g as E}from"./user.api-DrmP_lWn.js";import"./api-Czske0s_.js";const T=()=>{const i=y(),m=p(),{logout:o}=j(),[n,x]=c.useState(null),{register:d,handleSubmit:b,setValue:t,formState:{errors:M}}=v(),{data:s,isLoading:f}=w({queryKey:["myProfile"],queryFn:E});c.useEffect(()=>{s&&(t("nickname",s.nickname),t("bio",s.bio||""),x(s.avatar||null))},[s,t]);const a=u({mutationFn:async l=>await q(l),onSuccess:()=>{m.invalidateQueries({queryKey:["myProfile"]}),r.success("프로필이 업데이트되었습니다.")},onError:()=>r.error("수정 실패")}),h=u({mutationFn:C,onSuccess:()=>{o(),r.success("탈퇴 완료"),i("/")},onError:()=>r.error("탈퇴 실패")}),g=l=>a.mutate(l);return f?e.jsx("div",{className:"p-10 text-center",children:"로딩 중..."}):e.jsxs("div",{className:"max-w-2xl mx-auto px-4 pb-20",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-8",children:"설정"}),e.jsxs("form",{onSubmit:b(g),className:"space-y-8",children:[e.jsx("div",{className:"flex flex-col items-center gap-4",children:e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"w-28 h-28 rounded-full overflow-hidden border-4 border-white shadow-lg bg-gray-100",children:n?e.jsx("img",{src:n,alt:"Avatar",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:e.jsx(N,{size:40})})}),e.jsxs("label",{className:"absolute bottom-0 right-0 p-2 bg-gray-900 text-white rounded-full cursor-pointer hover:bg-primary",children:[e.jsx(k,{size:16}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*"})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"닉네임"}),e.jsx("input",{...d("nickname",{required:!0}),className:"w-full px-4 py-2 rounded-xl border bg-white dark:bg-gray-800"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"이메일"}),e.jsx("input",{value:s==null?void 0:s.email,disabled:!0,className:"w-full px-4 py-2 rounded-xl border bg-gray-100 text-gray-500 cursor-not-allowed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"자기소개"}),e.jsx("textarea",{...d("bio"),className:"w-full px-4 py-2 rounded-xl border bg-white dark:bg-gray-800 min-h-[100px]"})]})]}),e.jsxs("button",{type:"submit",disabled:a.isPending,className:"w-full py-3 bg-gray-900 text-white font-bold rounded-xl shadow-lg hover:bg-gray-800 flex justify-center gap-2",children:[e.jsx(S,{})," ",a.isPending?"저장 중...":"변경사항 저장"]})]}),e.jsx("hr",{className:"my-10 border-gray-200 dark:border-gray-700"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-bold text-red-500",children:"계정 관리"}),e.jsxs("button",{onClick:()=>{o(),i("/auth/login")},className:"w-full py-3 border text-gray-600 font-medium rounded-xl hover:bg-gray-50 flex justify-center gap-2",children:[e.jsx(F,{})," 로그아웃"]}),e.jsxs("button",{onClick:()=>window.confirm("정말 탈퇴하시겠습니까?")&&h.mutate(),className:"w-full py-3 border border-red-100 bg-red-50 text-red-600 font-medium rounded-xl hover:bg-red-100 flex justify-center gap-2",children:[e.jsx(P,{})," 회원 탈퇴"]})]})]})};export{T as default};
